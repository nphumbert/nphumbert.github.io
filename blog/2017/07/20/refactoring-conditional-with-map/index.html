<!doctype html><html lang=en-US><head><meta charset=utf-8><title>Refactoring Conditional Structures with Map</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Executive Advisor, Entrepreneur."><meta name=author content="Nadia Humbert-Labeaumaz"><meta name=generator content="Hugo 0.152.2"><meta property="og:url" content="https://nadiahl.com/blog/2017/07/20/refactoring-conditional-with-map/"><meta property="og:site_name" content="Nadia Z. Humbert-Labeaumaz"><meta property="og:title" content="Refactoring Conditional Structures with Map"><meta property="og:description" content="I often come across code snippets like this:
public class Day { public void start(Weather weather) { switch(weather) { case RAINY: takeAnUmbrella(); break; case SUNNY: takeAHat(); break; case STORMY: stayHome(); break; default: doNothing(); break; } } } Here, a specific action depends on the weather. This kind of code is both difficult to test and maintain. In this short article, I’ll show how to refactor it using a Map."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2017-07-20T15:32:15+01:00"><meta property="article:modified_time" content="2017-07-20T15:32:15+01:00"><meta property="article:tag" content="Software Design"><meta property="article:tag" content="Refactoring"><meta property="article:tag" content="Java"><meta property="og:image" content="https://nadiahl.com/images/blog/refactoring-conditional/header.jpg"><meta property="og:image" content="https://nadiahl.com/images/slider.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nadiahl.com/images/blog/refactoring-conditional/header.jpg"><meta name=twitter:image content="https://nadiahl.com/images/slider.jpg"><meta name=twitter:title content="Refactoring Conditional Structures with Map"><meta name=twitter:description content="I often come across code snippets like this:
public class Day { public void start(Weather weather) { switch(weather) { case RAINY: takeAnUmbrella(); break; case SUNNY: takeAHat(); break; case STORMY: stayHome(); break; default: doNothing(); break; } } } Here, a specific action depends on the weather. This kind of code is both difficult to test and maintain. In this short article, I’ll show how to refactor it using a Map."><meta property="twitter:creator" content="@nphumbert"><meta property="twitter:site" content="https://nadiahl.com/"><script async src="https://www.googletagmanager.com/gtag/js?id=G-FDXGPB3FE3"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FDXGPB3FE3")}</script><link rel=stylesheet href=/plugins/bootstrap/css/bootstrap.min.css media=screen><link rel=stylesheet href=/plugins/ionicons/css/ionicons.min.css><link rel=stylesheet href=/plugins/magnific-popup/magnific-popup.min.css><link rel=stylesheet href=/plugins/slick/slick.css><link rel=stylesheet href=/scss/style.min.css media=screen><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=icon href=/images/favicon.png type=image/x-icon><link rel=canonical href=https://nadiahl.com/blog/2017/07/20/refactoring-conditional-with-map/><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"Refactoring Conditional Structures with Map","image":"https:\/\/nadiahl.com\/images\/blog\/refactoring-conditional\/header.jpg","datePublished":"2017-07-20 15:32:15 \u002b0100 \u002b0100","author":[{"@type":"Person","name":"Nadia Z. Humbert-Labeaumaz","alternateName":"Nadia Humbert-Labeaumaz","url":"https:\/\/nadiahl.com\/#about"}]}</script></head><body><div class=preloader></div><header class=navigation><div class=container><div class=row><div class=col-md-12><nav class=navbar><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navigation>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse" id=navigation><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>Topics <span class=ion-ios-arrow-down style=padding-left:10px></span></a><ul class=dropdown-menu><li><a href=/topics/economics-finance/>Economics & Finance</a></li><li><a href=/topics/high-performing-teams/>High-Performing Teams</a></li><li><a href=/topics/organizational-change/>Organizational Change</a></li><li><a href=/topics/strategic-management/>Strategic Management</a></li><li><a href=/topics/technology-ai/>Technology & AI</a></li></ul></li><li><a href=/research>Research</a></li><li><a href=/essays>Essays</a></li><li><a href=/trainings>Trainings</a></li></ul></div></nav></div></div></div></header><section><div class=container><div class=row><div class=col-lg-8><picture><img src=/images/blog/refactoring-conditional/header.jpg alt="Refactoring Conditional Structures with Map"></picture><div class=taglist><ul class=list-inline><li><a href=/tags/software-design/>Software Design</a></li><li><a href=/tags/refactoring/>Refactoring</a></li><li><a href=/tags/java/>Java</a></li></ul></div><h1>Refactoring Conditional Structures with Map</h1><div class=meta><ul class=list-inline><li><a class=text-primary href=/#about>Nadia Z. Humbert-Labeaumaz</a></li><li>July 20, 2017</li><li>3 min read</li></ul></div><div id=email-modal class=hidden><div class=modal-content><button id=modal-close>&#215;</button><h2>Get the PDF</h2><p>Enter your email to access this document.</p><form id=email-form><input type=email id=email-input placeholder=you@example.com required>
<button type=submit>Access PDF</button><p id=form-message></p></form></div></div><div class="post-content post-excerpt"><p>I often come across code snippets like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Day</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>start</span>(Weather weather) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span>(weather) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> RAINY:
</span></span><span style=display:flex><span>          takeAnUmbrella();
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> SUNNY:
</span></span><span style=display:flex><span>          takeAHat();
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> STORMY:
</span></span><span style=display:flex><span>          stayHome();
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>          doNothing();
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here, a specific action depends on the weather. This kind of code is both difficult to test and maintain. In this short article, I&rsquo;ll show how to refactor it using a <code>Map</code>.</p><h2 id=what-is-the-problem>What is the Problem?</h2><p>Using conditional structures can be a sign of poor design. Indeed, as new cases need to be handled, this code will grow indefinitely, and the same piece of code may have to be modified repeatedly. Inevitably, a time will come when the code becomes so bloated that it is difficult to add new behaviour. This constitutes a violation of the <em>Open Closed Principle</em>, which stipulates that software should be open for extension but closed for modification. In other words, you should be able to add new behaviour without modifying the existing implementation.</p><h2 id=transform-the-imperative-algorithm-into-data>Transform the Imperative Algorithm into Data</h2><p>By analyzing this code, it becomes clear that this algorithm is no more than a <code>Map</code>: for each weather (the key), a piece of code needs to be executed (the value). Therefore, we can perform a first refactoring iteration to make this conceptual <code>Map</code> concrete:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Day</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> startOfTheDayActions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Day</span>() {
</span></span><span style=display:flex><span>    startOfTheDayActions.<span style=color:#a6e22e>put</span>(Weather.<span style=color:#a6e22e>RAINY</span>, <span style=color:#66d9ef>this</span>::takeAnUmbrella);
</span></span><span style=display:flex><span>    startOfTheDayActions.<span style=color:#a6e22e>put</span>(Weather.<span style=color:#a6e22e>SUNNY</span>, <span style=color:#66d9ef>this</span>::takeAHat);
</span></span><span style=display:flex><span>    startOfTheDayActions.<span style=color:#a6e22e>put</span>(Weather.<span style=color:#a6e22e>STORMY</span>, <span style=color:#66d9ef>this</span>::stayHome);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>start</span>(Weather weather) {
</span></span><span style=display:flex><span>    startOfTheDayActions.<span style=color:#a6e22e>getOrDefault</span>(weather, <span style=color:#66d9ef>this</span>::doNothing).<span style=color:#a6e22e>run</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The code is now already much clearer. The mapping between the weather and the action to perform is explicit, and it&rsquo;s no longer necessary to modify the <code>start</code> method algorithm very often: each new case only requires a new entry in the <code>Map</code>.</p><p>Nonetheless, this doesn&rsquo;t solve all issues. The class still needs modification to add a new entry. To address this, the <code>Map</code> can be passed as a parameter to the constructor.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Day</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> startOfTheDayActions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Day</span>(Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> startOfTheDayActions) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startOfTheDayActions</span> <span style=color:#f92672>=</span> startOfTheDayActions;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>start</span>(Weather weather) {
</span></span><span style=display:flex><span>    startOfTheDayActions.<span style=color:#a6e22e>getOrDefault</span>(weather, <span style=color:#66d9ef>this</span>::doNothing).<span style=color:#a6e22e>run</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now, the only responsibility of the class is to use the mapping to perform the correct action. This mapping becomes the responsibility of another class.</p><h2 id=note-about-spring-framework>Note about Spring Framework</h2><p>If you are using the Spring Framework and the <code>Day</code> class is a <code>@Component</code>, you can inject the <code>Map</code> as you would any other dependency.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Component</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Day</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> startOfTheDayActions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Day</span>(<span style=color:#a6e22e>@Qualifier</span>(<span style=color:#e6db74>&#34;startOfTheDayActions&#34;</span>) Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> startOfTheDayActions) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startOfTheDayActions</span> <span style=color:#f92672>=</span> startOfTheDayActions;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>start</span>(Weather weather) {
</span></span><span style=display:flex><span>    startOfTheDayActions.<span style=color:#a6e22e>getOrDefault</span>(weather, <span style=color:#66d9ef>this</span>::doNothing).<span style=color:#a6e22e>run</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ActionConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@Bean</span>(<span style=color:#e6db74>&#34;startOfTheDayActions&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>startOfTheDayActions</span>() {
</span></span><span style=display:flex><span>    Map<span style=color:#f92672>&lt;</span>Weather, Runnable<span style=color:#f92672>&gt;</span> actions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Create mapping</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> actions;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>This refactoring is easy to perform and reduces the complexity of a method efficiently. The code should reveal intention and avoid being bloated with conditional structures when unnecessary.</p></div></div><aside class=col-lg-4></div></div></div></div></section><footer class="footer bg-gray"><div class=container><div class=row><div class=col-md-12><div class=footer-menu><ul><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/research>Research</a></li><li><a href=/trainings>Trainings</a></li></ul></div><div class=footer-menu><ul><li><a href=/topics/economics-finance/>Economics & Finance</a></li><li><a href=/topics/high-performing-teams/>High-Performing Teams</a></li><li><a href=/topics/organizational-change/>Organizational Change</a></li><li><a href=/topics/strategic-management/>Strategic Management</a></li><li><a href=/topics/technology-ai/>Technology & AI</a></li></ul></div><div class=footer-menu><ul><li><a href=https://www.linkedin.com/in/nadia-humbert-labeaumaz/ target=_blank><i class=ion-social-linkedin-outline></i></a></li><li><a href=https://github.com/nphumbert target=_blank><i class=ion-social-github-outline></i></a></li><li><a href=https://twitter.com/nphumbert target=_blank><i class=ion-social-twitter-outline></i></a></li></ul></div><p class=copyright>© 2015-2025 Nadia Z. Humbert-Labeaumaz
<span style=display:none>(Nadia Humbert-Labeaumaz)</span></p></div></div></div></footer><script src=/plugins/jquery/jquery.min.js></script><script src=/plugins/bootstrap/js/bootstrap.min.js></script><script src=/plugins/slick/slick.min.js></script><script src=/plugins/magnific-popup/magnific-popup.min.js></script><script src=/plugins/shuffle/shuffle.min.js></script><script src=/plugins/google-map/gmap.js defer></script><script src=/js/script.min.js></script></body></html>