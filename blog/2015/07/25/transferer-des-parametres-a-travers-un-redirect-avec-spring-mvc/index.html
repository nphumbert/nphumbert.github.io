<!doctype html><html lang=en-US><head><meta charset=utf-8><title>Transférer des paramètres à travers un redirect avec Spring MVC</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Entrepreneur, consultant, bio-sciences and software engineer."><meta name=author content="Nadia Humbert-Labeaumaz"><meta name=generator content="Hugo 0.131.0"><meta property="og:image" content="https://nphumbert.github.io/images/blog/transfer-redirect-parameters/header.jpg"><meta property="og:url" content="https://nphumbert.github.io/blog/2015/07/25/transferer-des-parametres-a-travers-un-redirect-avec-spring-mvc/"><meta property="og:site_name" content="Nadia Humbert-Labeaumaz"><meta property="og:title" content="Transférer des paramètres à travers un redirect avec Spring MVC"><meta property="og:description" content="Dans une application web, il est courant d’effectuer une redirection après la soumission d’un formulaire. Cette redirection permet notamment de rendre l’url bookmarkable et d’empêcher l’utilisateur de resoumettre le formulaire par erreur (suite à un refresh, par exemple).
Il peut être intéressant de passer des paramètres à travers ce redirect. Par exemple, pour indiquer à l’utilisateur que son formulaire a bien été soumis. Pour ce faire, il est possible d’ajouter des paramètres directement dans l’url : redirect:/path/to/endpoint?formSubmitted=true. Cette solution n’est pas toujours adpatée pour des raisons de confidentialité, de taille d’url ou simplement d’esthétique.
L’objectif de cet article est de démontrer comment transférer des paramètres à travers une redirection avec Spring MVC en utilisant des flash attributes. L’exemple utilisé consistera en un formulaire qui permet d’envoyer un nom. Ce nom s’affichera ensuite une fois le formulaire soumis."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2015-07-25T12:06:04+02:00"><meta property="article:modified_time" content="2015-07-25T12:06:04+02:00"><meta property="article:tag" content="Java"><meta property="og:image" content="https://nphumbert.github.io/images/slider.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nphumbert.github.io/images/slider.jpg"><meta name=twitter:title content="Transférer des paramètres à travers un redirect avec Spring MVC"><meta name=twitter:description content="Dans une application web, il est courant d’effectuer une redirection après la soumission d’un formulaire. Cette redirection permet notamment de rendre l’url bookmarkable et d’empêcher l’utilisateur de resoumettre le formulaire par erreur (suite à un refresh, par exemple).
Il peut être intéressant de passer des paramètres à travers ce redirect. Par exemple, pour indiquer à l’utilisateur que son formulaire a bien été soumis. Pour ce faire, il est possible d’ajouter des paramètres directement dans l’url : redirect:/path/to/endpoint?formSubmitted=true. Cette solution n’est pas toujours adpatée pour des raisons de confidentialité, de taille d’url ou simplement d’esthétique.
L’objectif de cet article est de démontrer comment transférer des paramètres à travers une redirection avec Spring MVC en utilisant des flash attributes. L’exemple utilisé consistera en un formulaire qui permet d’envoyer un nom. Ce nom s’affichera ensuite une fois le formulaire soumis."><script async src="https://www.googletagmanager.com/gtag/js?id=G-FDXGPB3FE3"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FDXGPB3FE3")}</script><link rel=stylesheet href=/plugins/bootstrap/css/bootstrap.min.css media=screen><link rel=stylesheet href=/plugins/ionicons/css/ionicons.min.css><link rel=stylesheet href=/plugins/magnific-popup/magnific-popup.min.css><link rel=stylesheet href=/plugins/slick/slick.css><link rel=stylesheet href=/scss/style.min.css media=screen><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=icon href=/images/favicon.png type=image/x-icon><link rel=canonical href=https://nphumbert.github.io/blog/2015/07/25/transferer-des-parametres-a-travers-un-redirect-avec-spring-mvc/></head><body><div class=preloader></div><header class=navigation><div class=container><div class=row><div class=col-md-12><nav class=navbar><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navigation>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse" id=navigation><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/blog>Articles</a></li></ul></div></nav></div></div></div></header><section class="page-title bg-2" style=background-image:url(/images/blog/transfer-redirect-parameters/header.jpg)><div class=container><div class=row><div class=col-md-12><div class=block><h1>Transférer des paramètres à travers un redirect avec Spring MVC</h1><p></p></div></div></div></div></section><section class=page-wrapper><div class=container><div class=row><div class=col-md-8><div class="post post-single"><h2 class=post-title>Transférer des paramètres à travers un redirect avec Spring MVC</h2><div class=post-meta><ul><li><i class=ion-calendar></i> July 25, 2015</li><li><i class=ion-android-people></i>
Posted by
<a class=text-primary href=/author/nadia-humbert-labeaumaz>Nadia Humbert-Labeaumaz</a></li><li><i class=ion-pricetags></i>
<a href=/tags/java>Java</a></li></ul></div><div class=post-thumb><img class=img-responsive src=/images/blog/transfer-redirect-parameters/header.jpg alt="Transférer des paramètres à travers un redirect avec Spring MVC"></div><div class="post-content post-excerpt"><p>Dans une application web, il est courant d&rsquo;effectuer une redirection après la soumission d&rsquo;un formulaire. Cette redirection permet notamment de rendre l&rsquo;url <em>bookmarkable</em> et d&rsquo;empêcher l&rsquo;utilisateur de resoumettre le formulaire par erreur (suite à un <em>refresh</em>, par exemple).</p><p>Il peut être intéressant de passer des paramètres à travers ce redirect. Par exemple, pour indiquer à l&rsquo;utilisateur que son formulaire a bien été soumis. Pour ce faire, il est possible d&rsquo;ajouter des paramètres directement dans l&rsquo;url : <code>redirect:/path/to/endpoint?formSubmitted=true</code>.
Cette solution n&rsquo;est pas toujours adpatée pour des raisons de confidentialité, de taille d&rsquo;url ou simplement d&rsquo;esthétique.</p><p>L&rsquo;objectif de cet article est de démontrer comment transférer des paramètres à travers une redirection avec Spring MVC en utilisant des <em>flash attributes</em>. L&rsquo;exemple utilisé consistera en un formulaire qui permet d&rsquo;envoyer un nom. Ce nom s&rsquo;affichera ensuite une fois le formulaire soumis.</p><h2 id=traitement-du-formulaire>Traitement du formulaire</h2><p>Le code suivant décrit la gestion de la soumission du formulaire par un <em>controller</em> Spring MVC :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@RequestMapping</span>(value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/&#34;</span>, method <span style=color:#f92672>=</span> RequestMethod.<span style=color:#a6e22e>POST</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> ModelAndView <span style=color:#a6e22e>post</span>(<span style=color:#a6e22e>@RequestParam</span>(<span style=color:#e6db74>&#34;name&#34;</span>) String name, RedirectAttributes redirectAttributes) {
</span></span><span style=display:flex><span>   redirectAttributes.<span style=color:#a6e22e>addFlashAttribute</span>(<span style=color:#e6db74>&#34;name&#34;</span>, name); <span style=color:#75715e>// 1</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ModelAndView(<span style=color:#e6db74>&#34;redirect:/&#34;</span>); <span style=color:#75715e>// 2</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Afin d&rsquo;ajouter un <em>flash attribute</em> à la redirection, il faut utiliser une instance de la classe <code>RedirectAttributes</code> (<code>1</code>). Cette instance est automatiquement injectée par Spring lorsqu&rsquo;elle est déclarée dans la méthode du <em>controller</em>.</p><p>Une fois le <em>flash attribute</em> ajouté, il est possible de faire la redirection (<code>2</code>).</p><h2 id=traitement-de-laffichage>Traitement de l&rsquo;affichage</h2><p>Le code suivant décrit le traitement de la requête <code>GET</code> par un <em>controller</em> Spring MVC :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@RequestMapping</span>(value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/&#34;</span>, method <span style=color:#f92672>=</span> RequestMethod.<span style=color:#a6e22e>GET</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> ModelAndView <span style=color:#a6e22e>get</span>(HttpServletRequest request) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   ModelAndView modelAndView <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ModelAndView(<span style=color:#e6db74>&#34;default&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Map<span style=color:#f92672>&lt;</span>String, <span style=color:#f92672>?&gt;</span> flashMap <span style=color:#f92672>=</span> RequestContextUtils.<span style=color:#a6e22e>getInputFlashMap</span>(request); <span style=color:#75715e>// 1</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>CollectionUtils.<span style=color:#a6e22e>isEmpty</span>(flashMap)) {
</span></span><span style=display:flex><span>      modelAndView.<span style=color:#a6e22e>addObject</span>(<span style=color:#e6db74>&#34;name&#34;</span>, flashMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;name&#34;</span>)); <span style=color:#75715e>// 2</span>
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> modelAndView;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Pour récupérer la <em>map</em> contenant les <em>flash attributes</em>, il faut utiliser la méthode <code>RequestContextUtils.getInputFlashMap</code> sur la requête <code>HttpServletRequest</code> (<code>1</code>). Cette requête est également injectée par Spring lorsqu&rsquo;elle est déclarée dans la méthode du <em>controller</em>.</p><p>La valeur de l&rsquo;attribut peut alors être récupérée depuis la <em>map</em> pour être utilisée, ici dans le <code>ModelAndView</code> (<code>2</code>).</p><p>Ci-dessous un exemple est donné pour afficher conditionnellement cet attribut dans un template <a href=http://www.thymeleaf.org/>Thymeleaf</a> :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>&lt;</span>div <span style=color:#66d9ef>class</span><span style=color:#960050;background-color:#1e0010>=&#34;</span><span style=color:#a6e22e>alert</span> alert<span style=color:#f92672>-</span>success<span style=color:#e6db74>&#34; role=&#34;</span>alert<span style=color:#e6db74>&#34; th:if=&#34;</span>${not <span style=color:#960050;background-color:#1e0010>#</span>strings.<span style=color:#a6e22e>isEmpty</span>(name)}<span style=color:#e6db74>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   Hello, &lt;span th:text=&#34;</span>${name}<span style=color:#e6db74>&#34;&gt;John Doe&lt;/span&gt;!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;/div&gt;
</span></span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>Les <em>flash attributes</em> de Spring MVC peuvent être utilisés pour transférer des paramètres à travers une redirection. Ce mécanisme permet notamment d&rsquo;implémenter très facilement une confirmation de soumission de formulaire à l&rsquo;utilisateur.</p><p>Le code source du projet de démonstration peut être trouvé sur <a href=https://github.com/nphumbert/demo-flash-attributes>GitHub</a>.</p></div><div class=post-comments></div></div></div><div class=col-md-4><aside class=sidebar><div class="widget widget-latest-post"><h4 class=widget-title>Latest Posts</h4><div class=media><a class=pull-left href=/blog/2021/04/28/effecting-long-lasting-changes/><img class=media-object src=/images/blog/effecting-long-lasting-changes/header.jpg alt="How to Effect Long-Lasting Organisational Changes"></a><div class=media-body><h4 class=media-heading><a href=/blog/2021/04/28/effecting-long-lasting-changes/>How to Effect Long-Lasting Organisational Changes</a></h4></div></div><div class=media><a class=pull-left href=/blog/2021/01/14/what-is-a-social-entrepreneur/><img class=media-object src=/images/blog/what-is-a-social-entrepreneur/header.jpg alt="What is a Social Entrepreneur?"></a><div class=media-body><h4 class=media-heading><a href=/blog/2021/01/14/what-is-a-social-entrepreneur/>What is a Social Entrepreneur?</a></h4></div></div><div class=media><a class=pull-left href=/blog/2020/07/05/debt-sme-nz/><img class=media-object src=/images/blog/debt-sme-nz/header.jpg alt="Debt and SMEs in New Zealand"></a><div class=media-body><h4 class=media-heading><a href=/blog/2020/07/05/debt-sme-nz/>Debt and SMEs in New Zealand</a></h4></div></div><div class=media><a class=pull-left href=/blog/2019/06/27/cloudy-relationship-france-diesel/><img class=media-object src=/images/blog/diesel/header.jpg alt="The Cloudy Relationship Between France and Diesel"></a><div class=media-body><h4 class=media-heading><a href=/blog/2019/06/27/cloudy-relationship-france-diesel/>The Cloudy Relationship Between France and Diesel</a></h4></div></div></div><div class="widget widget-category"><h4 class=widget-title>Categories</h4><ul class=widget-category-list><li><a href=/categories/business/>Business</a></li><li><a href=/categories/case-studies/>Case Studies</a></li><li><a href=/categories/software/>Software</a></li></ul></div><div class="widget widget-tag"><h4 class=widget-title>Tags</h4><ul class=widget-tag-list><li><a href=/tags/change-management/>Change Management</a></li><li><a href=/tags/economics/>Economics</a></li><li><a href=/tags/finance/>Finance</a></li><li><a href=/tags/java/>Java</a></li><li><a href=/tags/refactoring/>Refactoring</a></li><li><a href=/tags/social-entrepreneurship/>Social Entrepreneurship</a></li><li><a href=/tags/software-design/>Software Design</a></li><li><a href=/tags/software-testing/>Software Testing</a></li></ul></div></aside></div></div></div></section><footer class=footer><div class=container><div class=row><div class=col-md-12><div class=footer-menu><ul><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/blog>Articles</a></li></ul></div><div class=footer-menu><ul><li><a href=https://www.linkedin.com/in/nadia-humbert-labeaumaz/ target=_blank><i class=ion-social-linkedin-outline></i></a></li><li><a href=https://github.com/nphumbert target=_blank><i class=ion-social-github-outline></i></a></li><li><a href=https://twitter.com/nphumbert target=_blank><i class=ion-social-twitter-outline></i></a></li></ul></div><p class=copyright></p></div></div></div></footer><script src=/plugins/jquery/jquery.min.js></script><script src=/plugins/bootstrap/js/bootstrap.min.js></script><script src=/plugins/slick/slick.min.js></script><script src=/plugins/magnific-popup/magnific-popup.min.js></script><script src=/plugins/shuffle/shuffle.min.js></script><script src=/plugins/google-map/gmap.js defer></script><script src=/js/script.min.js></script></body></html>