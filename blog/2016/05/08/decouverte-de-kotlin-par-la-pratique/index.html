<!doctype html><html lang=en-US><head><meta charset=utf-8><title>Découverte de Kotlin par la pratique</title>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Entrepreneur, consultant, bio-sciences and software engineer."><meta name=author content="Nadia Humbert-Labeaumaz"><meta name=generator content="Hugo 0.131.0"><meta property="og:image" content="https://nphumbert.github.io/images/blog/kotlin/header.png"><meta property="og:url" content="https://nphumbert.github.io/blog/2016/05/08/decouverte-de-kotlin-par-la-pratique/"><meta property="og:site_name" content="Nadia Humbert-Labeaumaz"><meta property="og:title" content="Découverte de Kotlin par la pratique"><meta property="og:description" content="Kotlin est un langage de programmation créé par JetBrains. Il est exécuté sur la JVM et est 100% interopérable avec Java 1.6+. J’ai découvert récemment ce langage et j’ai réalisé un ensemble de katas pour le pratiquer. Le code source de ces katas est disponible sur GitHub :
Prime factors String calculator Game of life Mars rover Dans cet article, je vais présenter des particularités de Kotlin que j’ai pu rencontrer."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2016-05-08T14:58:45+02:00"><meta property="article:modified_time" content="2016-05-08T14:58:45+02:00"><meta property="og:image" content="https://nphumbert.github.io/images/slider.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nphumbert.github.io/images/slider.jpg"><meta name=twitter:title content="Découverte de Kotlin par la pratique"><meta name=twitter:description content="Kotlin est un langage de programmation créé par JetBrains. Il est exécuté sur la JVM et est 100% interopérable avec Java 1.6+. J’ai découvert récemment ce langage et j’ai réalisé un ensemble de katas pour le pratiquer. Le code source de ces katas est disponible sur GitHub :
Prime factors String calculator Game of life Mars rover Dans cet article, je vais présenter des particularités de Kotlin que j’ai pu rencontrer."><script async src="https://www.googletagmanager.com/gtag/js?id=G-FDXGPB3FE3"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FDXGPB3FE3")}</script><link rel=stylesheet href=/plugins/bootstrap/css/bootstrap.min.css media=screen><link rel=stylesheet href=/plugins/ionicons/css/ionicons.min.css><link rel=stylesheet href=/plugins/magnific-popup/magnific-popup.min.css><link rel=stylesheet href=/plugins/slick/slick.css><link rel=stylesheet href=/scss/style.min.css media=screen><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=icon href=/images/favicon.png type=image/x-icon><link rel=canonical href=https://nphumbert.github.io/blog/2016/05/08/decouverte-de-kotlin-par-la-pratique/></head><body><div class=preloader></div><header class=navigation><div class=container><div class=row><div class=col-md-12><nav class=navbar><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navigation>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse" id=navigation><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/blog>Articles</a></li></ul></div></nav></div></div></div></header><section class="page-title bg-2" style=background-image:url(/images/blog/kotlin/header.png)><div class=container><div class=row><div class=col-md-12><div class=block><h1>Découverte de Kotlin par la pratique</h1><p></p></div></div></div></div></section><section class=page-wrapper><div class=container><div class=row><div class=col-md-8><div class="post post-single"><h2 class=post-title>Découverte de Kotlin par la pratique</h2><div class=post-meta><ul><li><i class=ion-calendar></i> May 8, 2016</li><li><i class=ion-android-people></i>
Posted by
<a class=text-primary href=/author/nadia-humbert-labeaumaz>Nadia Humbert-Labeaumaz</a></li><li><i class=ion-pricetags></i></li></ul></div><div class=post-thumb><img class=img-responsive src=/images/blog/kotlin/header.png alt="Découverte de Kotlin par la pratique"></div><div class="post-content post-excerpt"><p>Kotlin est un langage de programmation créé par JetBrains. Il est exécuté sur la JVM et est 100% interopérable avec Java 1.6+.
J&rsquo;ai découvert récemment ce langage et j&rsquo;ai réalisé un ensemble de katas pour le pratiquer.
Le code source de ces katas est disponible sur GitHub :</p><ul><li><a href=https://github.com/nphumbert/kata-prime-factors>Prime factors</a></li><li><a href=https://github.com/nphumbert/kata-string-calculator>String calculator</a></li><li><a href=https://github.com/nphumbert/kata-game-of-life>Game of life</a></li><li><a href=https://github.com/nphumbert/kata-mars-rover>Mars rover</a></li></ul><p>Dans cet article, je vais présenter des particularités de Kotlin que j&rsquo;ai pu rencontrer.</p><h2 id=généralités>Généralités</h2><p>En Kotlin, un fichier peut contenir plusieurs classes et des fonctions. Ces fonctions peuvent exister en dehors d&rsquo;une classe.
Un exemple de classe est donné ci-dessous :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Dimension</span>(<span style=color:#66d9ef>val</span> width: Int, <span style=color:#66d9ef>val</span> height: Int)
</span></span></code></pre></div><p>Le constructeur est défini dans la déclaration de la classe. Le mot clé <code>val</code> signifie que le champ est en lecture seule. Il faudrait utiliser <code>var</code> pour indiquer qu&rsquo;il est modifiable. De plus, des getters sont implicitement générés pour tous les champs qui ne sont pas <code>private</code> ainsi que des setters pour les champs qui ne sont pas en lecture seule. Par ailleurs, le mot clé <code>data</code> permet de créer automatiquement les méthodes <code>toString</code>, <code>equals</code>, <code>hashCode</code> et <code>clone</code>.</p><h2 id=gestion-des-null>Gestion des null</h2><p>Par défaut, les variables ne peuvent pas être nulles. Pour indiquer qu&rsquo;une variable peut être nulle, il faut ajouter un <code>?</code> à la fin du type. Par exemple, <code>val position: Position?</code>. Le fait d&rsquo;appeler une méthode sur une variable qui peut être nulle génère une erreur de compilation si ce n&rsquo;est pas géré explicitement.</p><p>Dans le code suivant, <code>moves</code> est une <code>Map</code> dont une valeur est récupérée à partir d&rsquo;une clé. Ceci peut retourner une valeur nulle si elle ne contient pas cette clé. S&rsquo;il est certain que la clé existe dans la <code>Map</code>, il faut forcer l&rsquo;appel avec <code>!!</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>apply</span>(position: Position): Position {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> moves[position.orientation]<span style=color:#f92672>!!</span>.invoke(position)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>S&rsquo;il n&rsquo;est pas certain que la clé existe dans la <code>Map</code>, il est possible d&rsquo;utiliser <code>?</code> pour appeler la méthode <code>invoke</code> sans risque d&rsquo;exception. En effet, si la valeur est nulle, la méthode ne sera pas appelée et le résultat sera <code>null</code>. Le code deviendrait donc le suivant :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>apply</span>(position: Position): Position? {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> moves[position.orientation]<span style=color:#f92672>?.</span>invoke(position)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Cette gestion des <code>null</code> permet d&rsquo;éviter les contrôles de nullité dispersés dans tout le code. De plus, elle permet de rendre très explicite les endroits où une variable peut être nulle. Finalement, tout ceci est vérifié par le compilateur, ce qui permet d&rsquo;éviter les oublis.</p><h2 id=valeurs-par-défaut>Valeurs par défaut</h2><p>Kotlin permet de donner aux paramètres des fonctions une valeur par défaut. Cette valeur est celle utilisée si le paramètre n&rsquo;est pas fourni lors de l&rsquo;appel de la fonction. La syntaxe pour mettre une valeur par défaut est décrite ci-après :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>add</span>(numbers: String, separator: Char = <span style=color:#e6db74>&#39;,&#39;</span>): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> numbers.split(separator).map { <span style=color:#66d9ef>it</span>.toInt() }.sum()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Cette fonction peut donc être appelée de deux manières différentes :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>add(numbers.joinToString(<span style=color:#e6db74>&#34;,&#34;</span>))
</span></span><span style=display:flex><span>add(numbers.joinToString(<span style=color:#e6db74>&#34;,&#34;</span>), <span style=color:#e6db74>&#39;,&#39;</span>)
</span></span></code></pre></div><p>Ce mécanisme permet de modifier du code existant, pour le rendre paramétrable par exemple, sans devoir changer le code client déjà existant ni devoir créer une nouvelle fonction qui se fera déléguer son traitement.</p><h2 id=streams>Streams</h2><p>L&rsquo;équivalent des <code>Streams</code> Java 8 sont gérés nativement par les classes Kotlin (même avec un JDK 1.6 !). Il est donc directement possible d&rsquo;appeler des méthodes comme <code>filter</code>, <code>map</code> ou <code>reduce</code> sur des collections. Par exemple, dans le jeu de la vie, pour compter toutes les cellules vivantes parmi les cellules voisines, il est possible de faire ceci :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>numberOfLiveNeighbours</span>(position: Position): Int =
</span></span><span style=display:flex><span>                      position.neighbours().filter { <span style=color:#66d9ef>get</span>(<span style=color:#66d9ef>it</span>).alive }.count()
</span></span></code></pre></div><p>Par ailleurs, d&rsquo;autres méthodes plus spécifiques sont disponibles selon le type de collection. Par exemple, sur une
<code>Map</code>, il est possible d&rsquo;appliquer des filtres seulement sur les valeurs grâce à la méthode <code>filterValues</code> :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>toString</span>(orientation: Orientation): String =
</span></span><span style=display:flex><span>                      orientations.filterValues { <span style=color:#66d9ef>it</span>.equals(orientation) }.keys.first().toString()
</span></span></code></pre></div><p>Le grand nombre de méthodes de ce genre facilite la programmation fonctionnelle et rend le code plus clair et expressif. De plus, le fait que Kotlin soit intéropérable avec Java permet d&rsquo;introduire des morceaux de code fonctionnel dans une base de code Java 6 ou 7.</p><h2 id=fonctions-dextension>Fonctions d&rsquo;extension</h2><p>Soit le code Kotlin suivant extrait du kata des facteurs premiers :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>primes.forEach {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (remains % <span style=color:#66d9ef>it</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        factors.add(<span style=color:#66d9ef>it</span>)
</span></span><span style=display:flex><span>        remains <span style=color:#f92672>/=</span> <span style=color:#66d9ef>it</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>La boucle ci-dessus continue tant que <code>remains</code> est un multiple du nombre premier courant. Il serait possible de rendre le code plus expressif de la manière suivante :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>primes.forEach {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (remains.isMultipleOf(<span style=color:#66d9ef>it</span>)) {
</span></span><span style=display:flex><span>        factors.add(<span style=color:#66d9ef>it</span>)
</span></span><span style=display:flex><span>        remains <span style=color:#f92672>/=</span> <span style=color:#66d9ef>it</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Le problème est que <code>remains</code> est un <code>Int</code> et que cette classe ne contient pas la méthode <code>isMultipleOf</code> par défaut. Cependant, il est possible de l&rsquo;ajouter grâce à une fonction d&rsquo;extension. il s&rsquo;agit de créer une fonction et de l&rsquo;ajouter à une classe de manière externe :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>Int</span>.isMultipleOf(number: Int): Boolean = <span style=color:#66d9ef>this</span>.mod(number) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>Les fonctions d&rsquo;extension sont très pratiques pour enrichir des objets, sans devoir modifier leur classe. De plus, ces extensions peuvent être restreintes à un certain contexte (une classe, un package, etc.).</p><h2 id=la-déstructuration>La déstructuration</h2><p>Lorsque l&rsquo;on souhaite extraire des objets depuis un tableau ou une liste, il est possible de s&rsquo;affranchir de l&rsquo;utilisation explicite des index en utilisant la déstructuration :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>val</span> <span style=color:#960050;background-color:#1e0010>(</span>gridDimensionInput, initialPositionInput, pathInput) = input.split(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Dans l&rsquo;exemple ci-dessus, l&rsquo;input va être découpée par ligne. La première ligne sera stockée dans <code>gridDimensionInput</code>, la seconde dans <code>initialPositionInput</code> et la troisième dans <code>pathInput</code>.</p><p>Ceci est également possible avec une <code>data class</code> de la façon suivante :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>val</span> position = Position(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>Orientation</span>.NORTH)
</span></span><span style=display:flex><span><span style=color:#66d9ef>val</span> <span style=color:#960050;background-color:#1e0010>(</span>x, y, orientation) = position
</span></span></code></pre></div><p>La déstructuration permet de simplifier l&rsquo;extraction de données depuis un objet qui la supporte sans devoir créer des variables intermédiaires qui ne serviront plus ensuite.</p><h2 id=création-de-type-implicite>Création de type implicite</h2><p>Quand un champ, un paramètre ou une variable doit être une fonction, sa signature peut être spécifiée lors de sa déclaration. Dans le kata Mars rover, une <code>Map</code> est utilisée pour associer à une orientation particulière du rover, une fonction qui va le faire avancer. Cette fonction doit prendre en paramètre une position et doit retourner la nouvelle position :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>val</span> moves = HashMap&lt;Orientation, (Position) <span style=color:#f92672>-&gt;</span> Position&gt;()
</span></span><span style=display:flex><span>moves.put(<span style=color:#a6e22e>Orientation</span>.NORTH, { Position(<span style=color:#66d9ef>it</span>.x, <span style=color:#66d9ef>it</span>.y.plus(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>it</span>.orientation) })
</span></span></code></pre></div><p>Cette manière de déclarer les types donne une très grande liberté sur la forme souhaitée pour le type. En effet, il n&rsquo;est pas nécessaire de créer un type explicitement pour l&rsquo;utiliser.</p><h2 id=conclusion>Conclusion</h2><p>Kotlin est un langage avec des opinions fortes. Je trouve que ceci le rend clair et très agréable à utiliser. Il force à se poser les bonnes questions au bon moment, pour la gestion des null par exemple. Ces questions étant résolues au moment approprié, il y a moins de soucis à se faire le reste du temps. De plus, ce langage est simple à écrire et à lire car il est peu verbeux et offre une grande expressivité. Par ailleurs, son intéropérabilité avec Java permet de l&rsquo;introduire dans des bases de code existantes sans devoir les modifier.</p></div><div class=post-comments></div></div></div><div class=col-md-4><aside class=sidebar><div class="widget widget-latest-post"><h4 class=widget-title>Latest Posts</h4><div class=media><a class=pull-left href=/blog/2021/04/28/effecting-long-lasting-changes/><img class=media-object src=/images/blog/effecting-long-lasting-changes/header.jpg alt="How to Effect Long-Lasting Organisational Changes"></a><div class=media-body><h4 class=media-heading><a href=/blog/2021/04/28/effecting-long-lasting-changes/>How to Effect Long-Lasting Organisational Changes</a></h4></div></div><div class=media><a class=pull-left href=/blog/2021/01/14/what-is-a-social-entrepreneur/><img class=media-object src=/images/blog/what-is-a-social-entrepreneur/header.jpg alt="What is a Social Entrepreneur?"></a><div class=media-body><h4 class=media-heading><a href=/blog/2021/01/14/what-is-a-social-entrepreneur/>What is a Social Entrepreneur?</a></h4></div></div><div class=media><a class=pull-left href=/blog/2020/07/05/debt-sme-nz/><img class=media-object src=/images/blog/debt-sme-nz/header.jpg alt="Debt and SMEs in New Zealand"></a><div class=media-body><h4 class=media-heading><a href=/blog/2020/07/05/debt-sme-nz/>Debt and SMEs in New Zealand</a></h4></div></div><div class=media><a class=pull-left href=/blog/2019/06/27/cloudy-relationship-france-diesel/><img class=media-object src=/images/blog/diesel/header.jpg alt="The Cloudy Relationship Between France and Diesel"></a><div class=media-body><h4 class=media-heading><a href=/blog/2019/06/27/cloudy-relationship-france-diesel/>The Cloudy Relationship Between France and Diesel</a></h4></div></div></div><div class="widget widget-category"><h4 class=widget-title>Categories</h4><ul class=widget-category-list><li><a href=/categories/business/>Business</a></li><li><a href=/categories/case-studies/>Case Studies</a></li><li><a href=/categories/software/>Software</a></li></ul></div><div class="widget widget-tag"><h4 class=widget-title>Tags</h4><ul class=widget-tag-list><li><a href=/tags/change-management/>Change Management</a></li><li><a href=/tags/economics/>Economics</a></li><li><a href=/tags/finance/>Finance</a></li><li><a href=/tags/java/>Java</a></li><li><a href=/tags/refactoring/>Refactoring</a></li><li><a href=/tags/social-entrepreneurship/>Social Entrepreneurship</a></li><li><a href=/tags/software-design/>Software Design</a></li><li><a href=/tags/software-testing/>Software Testing</a></li></ul></div></aside></div></div></div></section><footer class=footer><div class=container><div class=row><div class=col-md-12><div class=footer-menu><ul><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/blog>Articles</a></li></ul></div><div class=footer-menu><ul><li><a href=https://www.linkedin.com/in/nadia-humbert-labeaumaz/ target=_blank><i class=ion-social-linkedin-outline></i></a></li><li><a href=https://github.com/nphumbert target=_blank><i class=ion-social-github-outline></i></a></li><li><a href=https://twitter.com/nphumbert target=_blank><i class=ion-social-twitter-outline></i></a></li></ul></div><p class=copyright></p></div></div></div></footer><script src=/plugins/jquery/jquery.min.js></script><script src=/plugins/bootstrap/js/bootstrap.min.js></script><script src=/plugins/slick/slick.min.js></script><script src=/plugins/magnific-popup/magnific-popup.min.js></script><script src=/plugins/shuffle/shuffle.min.js></script><script src=/plugins/google-map/gmap.js defer></script><script src=/js/script.min.js></script></body></html>